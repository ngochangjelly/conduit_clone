{"ast":null,"code":"import axios from 'axios';\nimport { store } from '../store';\nimport { SET_USER, SET_USER_UPDATE } from '../constants/actionTypes';\nimport history from '../constants/history';\nexport const dispatchSignupData = data => {\n  return {\n    type: SET_USER,\n    data\n  };\n};\nexport const register = data => {\n  const username = data.username,\n        email = data.email,\n        password = data.password;\n  return dispatch => {\n    return axios.post(\"\".concat(process.env.REACT_APP_API, \"/users\"), {\n      user: {\n        username: username,\n        email: email,\n        password: password\n      }\n    }).then(response => {\n      localStorage.setItem('jwt', response.data.user.token);\n      dispatch(dispatchSignupData(response.data.user));\n      history.push('/');\n    }).catch(() => {});\n  };\n};\nexport const dispatchLoginInfo = data => {\n  return {\n    type: SET_USER,\n    data\n  };\n};\nexport const login = data => {\n  const username = data.username,\n        password = data.password;\n  return dispatch => {\n    return axios.post(\"\".concat(process.env.REACT_APP_API, \"/users/login\"), {\n      user: {\n        email: username,\n        password: password\n      }\n    }).then(response => {\n      localStorage.setItem('jwt', response.data.user.token);\n      dispatch(dispatchLoginInfo(response.data.user));\n      history.push('/');\n    }).catch(err => {\n      throw err;\n    });\n  };\n};\nexport const logout = data => {\n  window.localStorage.removeItem('jwt');\n  window.localStorage.removeItem('persist:root');\n  history.push('/');\n};\nexport const setUserUpdate = data => {\n  return {\n    type: SET_USER_UPDATE,\n    data\n  };\n};\nexport const updateUser = data => {\n  let user = Object.assign({}, data);\n  return dispatch => {\n    let config = {\n      headers: {\n        Authorization: \"Token \".concat(store.getState().auth.currentUser.token)\n      }\n    };\n    return axios.put(\"\".concat(process.env.REACT_APP_API, \"/user\"), {\n      user\n    }, config).then(res => {\n      dispatch(setUserUpdate(res.data.user));\n      user.hasOwnProperty('password') ? logout() : history.push('/');\n    }).catch(err => {\n      throw err;\n    });\n  };\n};","map":{"version":3,"sources":["/home/jelly/Desktop/conduit_clone/src/actions/auth.js"],"names":["axios","store","SET_USER","SET_USER_UPDATE","history","dispatchSignupData","data","type","register","username","email","password","dispatch","post","process","env","REACT_APP_API","user","then","response","localStorage","setItem","token","push","catch","dispatchLoginInfo","login","err","logout","window","removeItem","setUserUpdate","updateUser","Object","assign","config","headers","Authorization","getState","auth","currentUser","put","res","hasOwnProperty"],"mappings":"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","sourcesContent":["import axios from 'axios';\n\nimport { store } from '../store';\nimport { SET_USER, SET_USER_UPDATE } from '../constants/actionTypes';\nimport history from '../constants/history';\nexport const dispatchSignupData = data => {\n  return {\n    type: SET_USER,\n    data,\n  };\n};\nexport const register = data => {\n  const { username, email, password } = data;\n  return dispatch => {\n    return axios\n      .post(`${process.env.REACT_APP_API}/users`, {\n        user: {\n          username: username,\n          email: email,\n          password: password,\n        },\n      })\n      .then(response => {\n        localStorage.setItem('jwt', response.data.user.token);\n        dispatch(dispatchSignupData(response.data.user));\n        history.push('/');\n      })\n      .catch(() => {});\n  };\n};\nexport const dispatchLoginInfo = data => {\n  return {\n    type: SET_USER,\n    data,\n  };\n};\nexport const login = data => {\n  const { username, password } = data;\n  return dispatch => {\n    return axios\n      .post(`${process.env.REACT_APP_API}/users/login`, {\n        user: {\n          email: username,\n          password: password,\n        },\n      })\n      .then(response => {\n        localStorage.setItem('jwt', response.data.user.token);\n        dispatch(dispatchLoginInfo(response.data.user));\n        history.push('/');\n      })\n      .catch(err => {\n        throw err;\n      });\n  };\n};\nexport const logout = data => {\n  window.localStorage.removeItem('jwt');\n  window.localStorage.removeItem('persist:root');\n  history.push('/');\n};\nexport const setUserUpdate = data => {\n  return {\n    type: SET_USER_UPDATE,\n    data,\n  };\n};\nexport const updateUser = data => {\n  let user = Object.assign({}, data);\n  return dispatch => {\n    let config = {\n      headers: {\n        Authorization: `Token ${store.getState().auth.currentUser.token}`,\n      },\n    };\n    return axios\n      .put(\n        `${process.env.REACT_APP_API}/user`,\n        {\n          user,\n        },\n        config,\n      )\n      .then(res => {\n        dispatch(setUserUpdate(res.data.user));\n        user.hasOwnProperty('password') ? logout() : history.push('/');\n      })\n      .catch(err => {\n        throw err;\n      });\n  };\n};\n"]},"metadata":{},"sourceType":"module"}